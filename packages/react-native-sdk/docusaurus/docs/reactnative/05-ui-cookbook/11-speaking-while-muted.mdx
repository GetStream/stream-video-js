---
id: speaking-while-muted
title: Speaking While Muted
description: Speaking While Muted
---

:::warning
Write React Native Specifics

This documentation is for the beta version of the Stream Video SDK.
The SDK is subject to change.
:::


[//]: # ()
[//]: # (In this tutorial we will explore the ways to remind users they are speaking while being muted. The React SDK bundles [`SpeakingWhileMutedNotification`]&#40;../../ui-components/utility/speaking-while-muted-notification&#41; component, but we will discover how to build our own component.)

[//]: # ()
[//]: # (## Sound detection)

[//]: # ()
[//]: # (The sound detection can be easily implemented using [`createSoundDetector`]&#40;https://github.com/GetStream/stream-video-js/tree/main/packages/client/src/helpers/sound-detector.ts&#41; utility function. To learn more about this function, please see our [sound detection guide]&#40;../../guides/camera-and-microphone#sound-detection&#41;.)

[//]: # ()
[//]: # (## Speaking-while-muted notification component)

[//]: # ()
[//]: # (Our speaking-while-muted notification component will be based on simple principle of toggling a `isSpeakingWhileMuted` state. The UI will be rendered only, when `isSpeakingWhileMuted` is set to `true`. The state will be toggled based on the `isNotified` value passed to `onSoundDetectedStateChanged` handler of [`createSoundDetector`]&#40;https://github.com/GetStream/stream-video-js/tree/main/packages/client/src/helpers/sound-detector.ts&#41; utility function. The notification will be scheduled to disappear after 3.5 seconds.)

[//]: # ()
[//]: # (The example below detects sound during an active call, because we are retrieving the audio input device id from the call participant object.)

[//]: # ()
[//]: # (```tsx)

[//]: # (import { useEffect, useState } from 'react';)

[//]: # ()
[//]: # (import {)

[//]: # (  createSoundDetector,)

[//]: # (  SfuModels,)

[//]: # (  useLocalParticipant,)

[//]: # (  useMediaDevices,)

[//]: # (} from '@stream-io/video-react-sdk';)

[//]: # ()
[//]: # (export const SpeakingWhileMutedNotification = &#40;&#41; => {)

[//]: # (  const localParticipant = useLocalParticipant&#40;&#41;;)

[//]: # (  const { getAudioStream } = useMediaDevices&#40;&#41;;)

[//]: # ()
[//]: # (  // highlight-next-line)

[//]: # (  const isAudioMute = !localParticipant?.publishedTracks.includes&#40;)

[//]: # (    SfuModels.TrackType.AUDIO,)

[//]: # (  &#41;;)

[//]: # ()
[//]: # (  // in active call, the audio device id is available on the StreamVideoParticipant object)

[//]: # (  const audioDeviceId = localParticipant?.audioDeviceId;)

[//]: # ()
[//]: # (  // highlight-next-line)

[//]: # (  const [isSpeakingWhileMuted, setIsSpeakingWhileMuted] = useState&#40;false&#41;;)

[//]: # (  useEffect&#40;&#40;&#41; => {)

[//]: # (    // do not detect sound, when not muted)

[//]: # (    if &#40;!isAudioMute&#41; return;)

[//]: # ()
[//]: # (    const disposeSoundDetector = getAudioStream&#40;{)

[//]: # (      deviceId: audioDeviceId,)

[//]: # (    }&#41;.then&#40;&#40;audioStream&#41; =>)

[//]: # (      createSoundDetector&#40;audioStream, &#40;{ isSoundDetected }&#41; => {)

[//]: # (        // highlight-next-line)

[//]: # (        setIsSpeakingWhileMuted&#40;&#40;isNotified&#41; =>)

[//]: # (          // keep the UI rendered if previously enabled)

[//]: # (          isNotified ? isNotified : isSoundDetected,)

[//]: # (        &#41;;)

[//]: # (      }&#41;,)

[//]: # (    &#41;;)

[//]: # (    disposeSoundDetector.catch&#40;&#40;err&#41; => {)

[//]: # (      console.error&#40;'Error while creating sound detector', err&#41;;)

[//]: # (    }&#41;;)

[//]: # (    return &#40;&#41; => {)

[//]: # (      // make sure to dispose of used audio stream)

[//]: # (      disposeSoundDetector)

[//]: # (        .then&#40;&#40;dispose&#41; => dispose&#40;&#41;&#41;)

[//]: # (        .catch&#40;&#40;err&#41; => {)

[//]: # (          console.error&#40;'Error while disposing sound detector', err&#41;;)

[//]: # (        }&#41;;)

[//]: # (      setIsSpeakingWhileMuted&#40;false&#41;;)

[//]: # (    };)

[//]: # (  }, [audioDeviceId, getAudioStream, isAudioMute]&#41;;)

[//]: # ()
[//]: # (  useEffect&#40;&#40;&#41; => {)

[//]: # (    if &#40;!isSpeakingWhileMuted&#41; return;)

[//]: # (    // remove the UI after 3.5 seconds)

[//]: # (    const timeout = setTimeout&#40;&#40;&#41; => {)

[//]: # (      setIsSpeakingWhileMuted&#40;false&#41;;)

[//]: # (    }, 3500&#41;;)

[//]: # (    return &#40;&#41; => {)

[//]: # (      clearTimeout&#40;timeout&#41;;)

[//]: # (      setIsSpeakingWhileMuted&#40;false&#41;;)

[//]: # (    };)

[//]: # (  }, [isSpeakingWhileMuted]&#41;;)

[//]: # ()
[//]: # (  if &#40;!isSpeakingWhileMuted&#41; return null;)

[//]: # ()
[//]: # (  return <div>You are muted</div>;)

[//]: # (};)

[//]: # (```)

[//]: # ()
[//]: # (If we wanted to implement such notification outside an active call, we would need to access `selectedAudioInputDeviceId` and `initialAudioEnabled` from the `useMediaDevices` hook.)

[//]: # ()
[//]: # (```tsx)

[//]: # (import { useEffect, useState } from 'react';)

[//]: # ()
[//]: # (import {)

[//]: # (  createSoundDetector,)

[//]: # (  useMediaDevices,)

[//]: # (} from '@stream-io/video-react-sdk';)

[//]: # ()
[//]: # (export const SpeakingWhileMutedNotificationLobby = &#40;&#41; => {)

[//]: # (  // highlight-next-line)

[//]: # (  const { getAudioStream, initialAudioEnabled, selectedAudioInputDeviceId } =)

[//]: # (    useMediaDevices&#40;&#41;;)

[//]: # (  const [isSpeakingWhileMuted, setIsSpeakingWhileMuted] = useState&#40;false&#41;;)

[//]: # ()
[//]: # (  useEffect&#40;&#40;&#41; => {)

[//]: # (    // do not detect sound, when not muted)

[//]: # (    // highlight-next-line)

[//]: # (    if &#40;initialAudioEnabled&#41; return;)

[//]: # ()
[//]: # (    const disposeSoundDetector = getAudioStream&#40;{)

[//]: # (      // highlight-next-line)

[//]: # (      deviceId: selectedAudioInputDeviceId,)

[//]: # (    }&#41;.then&#40;&#40;audioStream&#41; =>)

[//]: # (      createSoundDetector&#40;audioStream, &#40;{ isSoundDetected }&#41; => {)

[//]: # (        setIsSpeakingWhileMuted&#40;&#40;isNotified&#41; =>)

[//]: # (          // keep the UI rendered if previously enabled)

[//]: # (          isNotified ? isNotified : isSoundDetected,)

[//]: # (        &#41;;)

[//]: # (      }&#41;,)

[//]: # (    &#41;;)

[//]: # (    disposeSoundDetector.catch&#40;&#40;err&#41; => {)

[//]: # (      console.error&#40;'Error while creating sound detector', err&#41;;)

[//]: # (    }&#41;;)

[//]: # (    return &#40;&#41; => {)

[//]: # (      disposeSoundDetector)

[//]: # (        .then&#40;&#40;dispose&#41; => dispose&#40;&#41;&#41;)

[//]: # (        .catch&#40;&#40;err&#41; => {)

[//]: # (          console.error&#40;'Error while disposing sound detector', err&#41;;)

[//]: # (        }&#41;;)

[//]: # (      setIsSpeakingWhileMuted&#40;false&#41;;)

[//]: # (    };)

[//]: # (    // highlight-next-line)

[//]: # (  }, [selectedAudioInputDeviceId, getAudioStream, initialAudioEnabled]&#41;;)

[//]: # ()
[//]: # (  useEffect&#40;&#40;&#41; => {)

[//]: # (    if &#40;!isSpeakingWhileMuted&#41; return;)

[//]: # (    // remove the UI after 3.5 seconds)

[//]: # (    const timeout = setTimeout&#40;&#40;&#41; => {)

[//]: # (      setIsSpeakingWhileMuted&#40;false&#41;;)

[//]: # (    }, 3500&#41;;)

[//]: # (    return &#40;&#41; => {)

[//]: # (      clearTimeout&#40;timeout&#41;;)

[//]: # (      setIsSpeakingWhileMuted&#40;false&#41;;)

[//]: # (    };)

[//]: # (  }, [isSpeakingWhileMuted]&#41;;)

[//]: # ()
[//]: # (  if &#40;!isSpeakingWhileMuted&#41; return null;)

[//]: # ()
[//]: # (  return <div>You are muted</div>;)

[//]: # (};)

[//]: # (```)
