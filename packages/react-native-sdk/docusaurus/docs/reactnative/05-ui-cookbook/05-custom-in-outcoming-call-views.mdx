---
id: custom-in-outcoming-call-views
title: Custom Incoming/Outgoing Call Views
---

:::warning
Write React Native Specifics

This documentation is for the beta version of the Stream Video SDK.
The SDK is subject to change.
:::

[//]: # ()
[//]: # (When building an application that relies on [`ring call workflow`]&#40;../../guides/joining-and-creating-calls/#ring-call&#41;, you'll often want to build your own incoming or outgoing call panels. The React SDK already comes with a pre-built [`PendingCallPanel`]&#40;../../ui-components/call/pending-call-panel&#41; component. However, in this article we will build a new one from scratch.)

[//]: # ()
[//]: # (The component will render:)

[//]: # ()
[//]: # (1. Call controls buttons to toggle audio and video enablement and accept resp. reject call buttons &#40;the component will be called `CallControls`&#41;)

[//]: # (2. Avatars of called users or the current user's video preview &#40;the component will be called `CallMembers`&#41;)

[//]: # (3. Call calling state indicator &#40;the component will be called `CallCallingStateLabel`&#41;)

[//]: # ()
[//]: # (## Project setup and prerequisites)

[//]: # ()
[//]: # (Make sure you have the following prerequisites checked:)

[//]: # ()
[//]: # (1. [Registered Stream account]&#40;https://getstream.io/try-for-free/&#41;)

[//]: # (2. Have an app created in the [Stream's dashboard]&#40;https://dashboard.getstream.io/&#41; to obtain app API key and secret.)

[//]: # (3. Initiate the project &#40;you can follow our [introductory tutorial setup guide]&#40;../../tutorials/video-calling#set-up-for-success&#41;&#41;)

[//]: # (4. Have installed the Stream video and chat SDKs in the project:)

[//]: # ()
[//]: # (```shell)

[//]: # (npm install @stream-io/video-react-sdk)

[//]: # (```)

[//]: # ()
[//]: # (```shell)

[//]: # (yarn add @stream-io/video-react-sdk)

[//]: # (```)

[//]: # ()
[//]: # (## App boilerplate)

[//]: # ()
[//]: # (In order we can start performing calls we need a `StreamVideoClient` instance connected to the Stream's server network with app credentials. For more information on how to do that, please take a look at our [authentication guide]&#40;../../guides/client-auth#setting-up-a-streamvideoclient-and-connecting-a-user&#41;.)

[//]: # ()
[//]: # (## Pending call panel implementation)

[//]: # ()
[//]: # (The component will rely on data accessed via our utility hooks:)

[//]: # ()
[//]: # (- `useCall`)

[//]: # (- `useCallCallingState`)

[//]: # (- `useCallMetadata`)

[//]: # (- `useCallMembers`)

[//]: # (- `useMediaDevices`)

[//]: # ()
[//]: # (### User preview)

[//]: # ()
[//]: # (The panel will render [`VideoPreview`]&#40;../../ui-components/participants/video-preview&#41; so that the user can see the camera input or avatars if video preview is disabled. The avatar display logic is as follows:)

[//]: # ()
[//]: # (- show all the called users' avatars if the call is outgoing &#40;who am I calling&#41;)

[//]: # (- show the avatar of the person who initiated the call in case of an incoming call &#40;who is calling me&#41;)

[//]: # ()
[//]: # (:::note)

[//]: # (Note, how the initial video state is handled by [`MediaDevicesProvider`]&#40;../../guides/camera-and-microphone&#41;. We only consume the API through corresponding context consumer hook `useMediaDevices`.)

[//]: # (:::)

[//]: # ()
[//]: # (```tsx)

[//]: # (import {)

[//]: # (  useCall,)

[//]: # (  useCallMembers,)

[//]: # (  useCallMetadata,)

[//]: # (  useMediaDevices,)

[//]: # (  VideoPreview,)

[//]: # (} from '@stream-io/video-react-sdk';)

[//]: # ()
[//]: # (import type { UserResponse } from '@stream-io/video-react-sdk';)

[//]: # ()
[//]: # (import { CallCallingStateLabel } from './CallCallingStateLabel';)

[//]: # (import { CallControls } from './CallControls';)

[//]: # (import { CallMembers } from './CallMembers';)

[//]: # ()
[//]: # (type PendingCallPanelProps = {)

[//]: # (  showMemberCount?: number;)

[//]: # (};)

[//]: # ()
[//]: # (export const CustomPendingCallPanel = &#40;{)

[//]: # (  showMemberCount = 3,)

[//]: # (}: PendingCallPanelProps&#41; => {)

[//]: # (  const call = useCall&#40;&#41;;)

[//]: # (  const metadata = useCallMetadata&#40;&#41;;)

[//]: # (  const members = useCallMembers&#40;&#41;;)

[//]: # (  // highlight-next-line)

[//]: # (  const { initialVideoState } = useMediaDevices&#40;&#41;;)

[//]: # ()
[//]: # (  if &#40;!call&#41; return null;)

[//]: # ()
[//]: # (  const caller = metadata?.created_by;)

[//]: # (  // show the caller if this is an incoming call or show all the users I am calling to)

[//]: # (  let membersToShow: UserResponse[] = [];)

[//]: # (  if &#40;call.isCreatedByMe&#41; {)

[//]: # (    membersToShow =)

[//]: # (      members)

[//]: # (        ?.slice&#40;0, showMemberCount&#41;)

[//]: # (        .map&#40;&#40;{ user }&#41; => user&#41;)

[//]: # (        .filter&#40;&#40;u&#41; => !!u&#41; || [];)

[//]: # (  } else if &#40;caller&#41; {)

[//]: # (    membersToShow = [caller];)

[//]: # (  })

[//]: # ()
[//]: # (  return &#40;)

[//]: # (    <div>)

[//]: # (      // highlight-next-line)

[//]: # (      {initialVideoState.enabled ? &#40;)

[//]: # (        <VideoPreview />)

[//]: # (      &#41; : &#40;)

[//]: # (        <CallMembers members={membersToShow} />)

[//]: # (      &#41;})

[//]: # (      <CallCallingStateLabel />)

[//]: # (      <CallControls />)

[//]: # (    </div>)

[//]: # (  &#41;;)

[//]: # (};)

[//]: # (```)

[//]: # ()
[//]: # (#### Video preview enablement)

[//]: # ()
[//]: # (Enable the initial video in [`VideoPreview`]&#40;../../ui-components/participants/video-preview&#41; component with `mediaDevicesProviderProps` prop on [`StreamCall`]&#40;../../ui-components/core/stream-call&#41; component. In the snippet below, the `CallPanel` component is expected to render our `CustomPendingCallPanel`.)

[//]: # ()
[//]: # (```tsx)

[//]: # (import {)

[//]: # (  CallingState,)

[//]: # (  StreamCall,)

[//]: # (  useCall,)

[//]: # (  useCallCallingState,)

[//]: # (  useCalls,)

[//]: # (} from '@stream-io/video-react-sdk';)

[//]: # ()
[//]: # (import { CustomActiveCallPanel } from './CustomActiveCallPanel';)

[//]: # (import { CustomPendingCallPanel } from './CustomPendingCallPanel';)

[//]: # ()
[//]: # (export const Video = &#40;&#41; => {)

[//]: # (  const calls = useCalls&#40;&#41;;)

[//]: # (  return &#40;)

[//]: # (    <>)

[//]: # (      {calls.map&#40;&#40;call&#41; => &#40;)

[//]: # (        <StreamCall)

[//]: # (          call={call})

[//]: # (          key={call.cid})

[//]: # (          // highlight-next-line)

[//]: # (          mediaDevicesProviderProps={{ initialVideoEnabled: true }})

[//]: # (        >)

[//]: # (          <CallPanel />)

[//]: # (        </StreamCall>)

[//]: # (      &#41;&#41;})

[//]: # (    </>)

[//]: # (  &#41;;)

[//]: # (};)

[//]: # ()
[//]: # (// custom component that renders pending as well as active call UI)

[//]: # (const CallPanel = &#40;&#41; => {)

[//]: # (  const call = useCall&#40;&#41;;)

[//]: # (  const callingState = useCallCallingState&#40;&#41;;)

[//]: # ()
[//]: # (  if &#40;!call&#41; return null;)

[//]: # ()
[//]: # (  if &#40;callingState === CallingState.JOINED&#41; {)

[//]: # (    return <CustomActiveCallPanel />;)

[//]: # (  } else if &#40;)

[//]: # (    [CallingState.RINGING, CallingState.JOINING].includes&#40;callingState&#41;)

[//]: # (  &#41; {)

[//]: # (    return <CustomPendingCallPanel />;)

[//]: # (  })

[//]: # ()
[//]: # (  return null;)

[//]: # (};)

[//]: # (```)

[//]: # ()
[//]: # (Or, if instead of using [`StreamCall`]&#40;../../ui-components/core/stream-call&#41;, we want to use the `MediaDevicesProvider` component directly, we pass `initialVideoEnabled` value to it as follows:)

[//]: # ()
[//]: # (```tsx)

[//]: # (import { MediaDevicesProvider } from "@stream-io/video-react-sdk";)

[//]: # ()
[//]: # (const SomeComponent = &#40;&#41; => {)

[//]: # (    return &#40;)

[//]: # (        ...)

[//]: # (        <MediaDevicesProvider initialVideoEnabled>)

[//]: # (          ...)

[//]: # (        </MediaDevicesProvider>)

[//]: # (        ...)

[//]: # (    &#41;)

[//]: # (})

[//]: # (```)

[//]: # ()
[//]: # (#### User avatars)

[//]: # ()
[//]: # (We display relevant users' avatars with `CallMembers` component.)

[//]: # ()
[//]: # (```tsx)

[//]: # (import { Avatar } from '@stream-io/video-react-sdk';)

[//]: # ()
[//]: # (import type { UserResponse } from '@stream-io/video-react-sdk';)

[//]: # ()
[//]: # (type CallMembersProps = {)

[//]: # (  members: UserResponse[];)

[//]: # (};)

[//]: # (const CallMembers = &#40;{ members }: CallMembersProps&#41; => {)

[//]: # (  return &#40;)

[//]: # (    <div>)

[//]: # (      {members.map&#40;&#40;member&#41; => &#40;)

[//]: # (        <div key={member.id}>)

[//]: # (          <Avatar name={member.name} imageSrc={member.image} />)

[//]: # (          {member.name && &#40;)

[//]: # (            <div>)

[//]: # (              <span>{member.name}</span>)

[//]: # (            </div>)

[//]: # (          &#41;})

[//]: # (        </div>)

[//]: # (      &#41;&#41;})

[//]: # (    </div>)

[//]: # (  &#41;;)

[//]: # (};)

[//]: # (```)

[//]: # ()
[//]: # (### Call calling state label)

[//]: # ()
[//]: # (To show to our users the state of call connection, we implement `CallCallingStateLabel`. The calling state is provided by `useCallCallingState` hook:)

[//]: # ()
[//]: # (:::note)

[//]: # (In this component we are using translation service that comes bundled with the SDK. The service API is consumed with `useI18n` hook. Learn more about using the [i18n service in the dedicated documentation]&#40;../../advanced/i18n&#41;.)

[//]: # (:::)

[//]: # ()
[//]: # (```tsx)

[//]: # (import {)

[//]: # (  CallingState,)

[//]: # (  useCallCallingState,)

[//]: # (  useI18n,)

[//]: # (} from '@stream-io/video-react-sdk';)

[//]: # ()
[//]: # (const CALLING_STATE_TO_LABEL: Record<CallingState, string> = {)

[//]: # (  [CallingState.JOINING]: 'Joining',)

[//]: # (  [CallingState.RINGING]: 'Ringing',)

[//]: # (  [CallingState.RECONNECTING]: 'Re-connecting',)

[//]: # (  [CallingState.RECONNECTING_FAILED]: 'Failed',)

[//]: # (  [CallingState.OFFLINE]: 'No internet connection',)

[//]: # (  [CallingState.IDLE]: '',)

[//]: # (  [CallingState.UNKNOWN]: '',)

[//]: # (  [CallingState.JOINED]: 'Joined',)

[//]: # (  [CallingState.LEFT]: 'Left call',)

[//]: # (};)

[//]: # ()
[//]: # (const CallCallingStateLabel = &#40;&#41; => {)

[//]: # (  const { t } = useI18n&#40;&#41;;)

[//]: # (  const callingState = useCallCallingState&#40;&#41;;)

[//]: # (  const callingStateLabel = CALLING_STATE_TO_LABEL[callingState];)

[//]: # ()
[//]: # (  return callingStateLabel ? <div>{t&#40;callingStateLabel&#41;}</div> : null;)

[//]: # (};)

[//]: # (```)

[//]: # ()
[//]: # (### Call controls)

[//]: # ()
[//]: # (Finally, we build the call control buttons. We include buttons to toggle camera and microphone and buttons to accept and reject the call.)

[//]: # ()
[//]: # (:::note)

[//]: # (The toggle video and audio buttons are just wrappers around pre-built button components attaching click handlers provided by `MediaDevicesProvider`.)

[//]: # (:::)

[//]: # ()
[//]: # (```tsx)

[//]: # (import {)

[//]: # (  AcceptCallButton,)

[//]: # (  CallingState,)

[//]: # (  CancelCallButton,)

[//]: # (  IconButton,)

[//]: # (  useCall,)

[//]: # (  useCallCallingState,)

[//]: # (  useMediaDevices,)

[//]: # (} from '@stream-io/video-react-sdk';)

[//]: # ()
[//]: # (const CallControls = &#40;&#41; => {)

[//]: # (  const call = useCall&#40;&#41;;)

[//]: # (  const callingState = useCallCallingState&#40;&#41;;)

[//]: # ()
[//]: # (  if &#40;!call&#41; return null;)

[//]: # (  // show pending call panel components only before the call is joined)

[//]: # (  if &#40;![CallingState.RINGING, CallingState.JOINING].includes&#40;callingState&#41;&#41;)

[//]: # (    return null;)

[//]: # ()
[//]: # (  // prevent users from rejecting call when already accepted)

[//]: # (  const buttonsDisabled = callingState === CallingState.JOINING;)

[//]: # ()
[//]: # (  return &#40;)

[//]: # (    <div>)

[//]: # (      <ToggleAudioButton />)

[//]: # (      <ToggleVideoButton />)

[//]: # (      {call.isCreatedByMe ? &#40;)

[//]: # (        <CancelCallButton call={call} disabled={buttonsDisabled} />)

[//]: # (      &#41; : &#40;)

[//]: # (        <>)

[//]: # (          <AcceptCallButton call={call} disabled={buttonsDisabled} />)

[//]: # (          <CancelCallButton)

[//]: # (            onClick={&#40;&#41; => call.leave&#40;{ reject: true }&#41;})

[//]: # (            disabled={buttonsDisabled})

[//]: # (          />)

[//]: # (        </>)

[//]: # (      &#41;})

[//]: # (    </div>)

[//]: # (  &#41;;)

[//]: # (};)

[//]: # ()
[//]: # (const ToggleAudioButton = &#40;&#41; => {)

[//]: # (  const { initialAudioEnabled, toggleInitialAudioMuteState } =)

[//]: # (    useMediaDevices&#40;&#41;;)

[//]: # ()
[//]: # (  return &#40;)

[//]: # (    <IconButton)

[//]: # (      icon={initialAudioEnabled ? 'mic' : 'mic-off'})

[//]: # (      onClick={toggleInitialAudioMuteState})

[//]: # (    />)

[//]: # (  &#41;;)

[//]: # (};)

[//]: # ()
[//]: # (const ToggleVideoButton = &#40;&#41; => {)

[//]: # (  const { toggleInitialVideoMuteState, initialVideoState } = useMediaDevices&#40;&#41;;)

[//]: # ()
[//]: # (  return &#40;)

[//]: # (    <IconButton)

[//]: # (      icon={initialVideoState.enabled ? 'camera' : 'camera-off'})

[//]: # (      onClick={toggleInitialVideoMuteState})

[//]: # (    />)

[//]: # (  &#41;;)

[//]: # (};)

[//]: # (```)
