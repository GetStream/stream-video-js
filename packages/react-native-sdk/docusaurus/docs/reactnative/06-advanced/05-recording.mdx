---
id: recording
title: Recording
description: Recording
---

:::info
This page is still in progress and will be updated soon.
If you have any questions, please reach out to us on our [website](https://getstream.io/video/#contact).
:::

[//]: # ()
[//]: # (One highly sought-after feature in many communication applications is call recording. Whether it's for legal compliance, quality assurance, or simply for future reference, the ability to record calls is essential in numerous scenarios.)

[//]: # ()
[//]: # (This documentation article serves as a guide for implementing a call recording feature in your application. We will explore the technical aspects and best practices involved in capturing and storing recording data during calls.)

[//]: # ()
[//]: # (## Recording calls)

[//]: # ()
[//]: # (The `Call` objects exposes the call recording API. To start recording, we simply invoke `call.startRecording&#40;&#41;`. To stop recording, we use `call.stopRecording&#40;&#41;`.)

[//]: # (To determine, whether a call recording is in progress, we use `useIsCallRecordingInProgress` hook. This may serve us well, when we want to provide visual clues about the recording state. We have to be aware, that it can take few moments until a call recording starts. We recommend to keep own state signalling that the call recording is starting, but has not begun yet.)

[//]: # ()
[//]: # (```tsx)

[//]: # (import { useCallback, useEffect, useState } from 'react';)

[//]: # (import {)

[//]: # (  useCall,)

[//]: # (  useIsCallRecordingInProgress,)

[//]: # (} from '@stream-io/video-react-bindings';)

[//]: # ()
[//]: # (import { LoadingIndicator } from '../LoadingIndicator';)

[//]: # ()
[//]: # (export const CustomCallRecordButton = &#40;&#41; => {)

[//]: # (  const call = useCall&#40;&#41;;)

[//]: # (  const isCallRecordingInProgress = useIsCallRecordingInProgress&#40;&#41;;)

[//]: # (  const [isAwaitingResponse, setIsAwaitingResponse] = useState&#40;false&#41;;)

[//]: # ()
[//]: # (  useEffect&#40;&#40;&#41; => {)

[//]: # (    // we wait until call.recording_started/stopped event to flips the)

[//]: # (    // `isCallRecordingInProgress` state variable.)

[//]: # (    // Once the flip happens, we remove the loading indicator)

[//]: # (    setIsAwaitingResponse&#40;&#40;isAwaiting&#41; => {)

[//]: # (      if &#40;isAwaiting&#41; return false;)

[//]: # (      return isAwaiting;)

[//]: # (    }&#41;;)

[//]: # (  }, [isCallRecordingInProgress]&#41;;)

[//]: # ()
[//]: # (  const toggleRecording = useCallback&#40;async &#40;&#41; => {)

[//]: # (    try {)

[//]: # (      setIsAwaitingResponse&#40;true&#41;;)

[//]: # (      if &#40;isCallRecordingInProgress&#41; {)

[//]: # (        await call?.stopRecording&#40;&#41;;)

[//]: # (      } else {)

[//]: # (        await call?.startRecording&#40;&#41;;)

[//]: # (      })

[//]: # (    } catch &#40;e&#41; {)

[//]: # (      console.error&#40;`Failed start recording`, e&#41;;)

[//]: # (    })

[//]: # (  }, [call, isCallRecordingInProgress]&#41;;)

[//]: # ()
[//]: # (  return isAwaitingResponse ? &#40;)

[//]: # (    <LoadingIndicator />)

[//]: # (  &#41; : &#40;)

[//]: # (    <button onClick={toggleRecording}>{/* Button content */}</button>)

[//]: # (  &#41;;)

[//]: # (};)

[//]: # (```)

[//]: # ()
[//]: # (### Permissions)

[//]: # ()
[//]: # (To start and stop recording, the user has to have corresponding permissions. We therefore encourage the integrators to check the permissions before allowing users to execute a given action. The SDK bundles component [`Restricted`]&#40;https://github.com/GetStream/stream-video-js/tree/main/packages/react-sdk/src/wrappers/Restricted&#41; that renders its children only if the user has sufficient permissions. The SDK's [`RecordCallButton`]&#40;../../ui-components/call/call-controls/#recordcallbutton&#41; makes use of the [`Restricted`]&#40;https://github.com/GetStream/stream-video-js/tree/main/packages/react-sdk/src/wrappers/Restricted&#41; component.)

[//]: # ()
[//]: # (To learn more about permissions, take a look at our [permissions guide]&#40;../../guides/permissions-and-moderation&#41;.)

[//]: # ()
[//]: # (### Call recording SDK components)

[//]: # ()
[//]: # (The React SDK comes with [`RecordCallButton`]&#40;../../ui-components/call/call-controls/#recordcallbutton&#41;, that takes care of initiating the call recording.)

[//]: # ()
[//]: # (## Acquiring call recordings data)

[//]: # ()
[//]: # (The call recording data can be retrieved by calling the `Call` method `queryRecordings&#40;&#41;`. By default, it retrieves all the call recordings for a given call &#40;call CID&#41;. However, it accepts a single argument `callSessionId` that allows us to retrieve only recordings done during a single call session. The method returns `ListRecordingsResponse` that carries an array of `CallRecording` objects accessible through `recordings` key.)

[//]: # ()
[//]: # (:::note)

[//]: # (Multiple calls can be recorded during a single call session, but a single call CID can be reused for multiple sessions, too.)

[//]: # (:::)

[//]: # ()
[//]: # (With every call to `call.queryRecordings&#40;&#41;`, the call state is updated with the latest array of `CallRecording` objects. The latest value is then always emitted through the `useCallRecordings` hook.)

[//]: # ()
[//]: # (:::warning)

[//]: # (The call recording list has to be queried explicitly and is not automatically updated at any stage of a call.)

[//]: # (:::)

[//]: # ()
[//]: # (If we wanted to keep and up-to-date list of call recordings during an active call, we would need to query them at the start of the call as well as with every [`call.recording_stopped` event]&#40;../events&#41;.)

[//]: # ()
[//]: # (:::note)

[//]: # (The call recording is not immediately available when the `call.recording_stopped` event is delivered. It may take 30 or more seconds for a recording to be available. Therefore, polling mechanism has to be introduced to check, whether the latest list of call recordings returned from the query contains a new item.)

[//]: # (:::)

[//]: # ()
[//]: # (```tsx)

[//]: # (import { forwardRef, useEffect, useRef, useState } from 'react';)

[//]: # (import {)

[//]: # (  CallRecording,)

[//]: # (  CallRecordingList,)

[//]: # (  IconButton,)

[//]: # (  MenuToggle,)

[//]: # (  ToggleMenuButtonProps,)

[//]: # (  useCall,)

[//]: # (  useCallRecordings,)

[//]: # (  useStreamVideoClient,)

[//]: # (} from '@stream-io/video-react-sdk';)

[//]: # ()
[//]: # (const MAX_NUMBER_POLL_REQUESTS = 6;)

[//]: # (const POLL_INTERVAL_MS = 10 * 1000;)

[//]: # ()
[//]: # (export const CallRecordings = &#40;&#41; => {)

[//]: # (  const callRecordings = useCallRecordings&#40;&#41;;)

[//]: # (  const client = useStreamVideoClient&#40;&#41;;)

[//]: # (  const activeCall = useCall&#40;&#41;;)

[//]: # ()
[//]: # (  const [loadingCallRecordings, setLoadingCallRecordings] = useState&#40;false&#41;;)

[//]: # (  const recordingPollRequestsCount = useRef&#40;0&#41;;)

[//]: # (  const recordingPollRequestsInterval = useRef<)

[//]: # (    ReturnType<typeof setInterval> | undefined)

[//]: # (  >&#40;&#41;;)

[//]: # ()
[//]: # (  useEffect&#40;&#40;&#41; => {)

[//]: # (    if &#40;!&#40;client && activeCall && callRecordings&#41;&#41; return;)

[//]: # ()
[//]: # (    const scheduleCallRecordingPolling = &#40;&#41; => {)

[//]: # (      setLoadingCallRecordings&#40;true&#41;;)

[//]: # ()
[//]: # (      if &#40;recordingPollRequestsInterval.current&#41; {)

[//]: # (        clearInterval&#40;recordingPollRequestsInterval.current&#41;;)

[//]: # (      })

[//]: # ()
[//]: # (      recordingPollRequestsInterval.current = setInterval&#40;async &#40;&#41; => {)

[//]: # (        let recordings: CallRecording[] = [];)

[//]: # (        try {)

[//]: # (          const response = await activeCall.queryRecordings&#40;&#41;;)

[//]: # (          recordings = response.recordings;)

[//]: # (        } catch &#40;e&#41; {)

[//]: # (          console.error&#40;'Failed to query recordings', e&#41;;)

[//]: # (        } finally {)

[//]: # (          recordingPollRequestsCount.current++;)

[//]: # (          const hasNewRecordings = callRecordings.length < recordings.length;)

[//]: # ()
[//]: # (          if &#40;)

[//]: # (            recordingPollRequestsCount.current === MAX_NUMBER_POLL_REQUESTS ||)

[//]: # (            hasNewRecordings)

[//]: # (          &#41; {)

[//]: # (            clearInterval&#40;recordingPollRequestsInterval.current&#41;;)

[//]: # (            setLoadingCallRecordings&#40;false&#41;;)

[//]: # (          })

[//]: # (        })

[//]: # (      }, POLL_INTERVAL_MS&#41;;)

[//]: # (    };)

[//]: # ()
[//]: # (    // register a polling mechanism once the recording has been stopped)

[//]: # (    client.on&#40;'call.recording_stopped', scheduleCallRecordingPolling&#41;;)

[//]: # ()
[//]: # (    return &#40;&#41; => {)

[//]: # (      client.off&#40;'call.recording_stopped', scheduleCallRecordingPolling&#41;;)

[//]: # (    };)

[//]: # (  }, [client, activeCall, callRecordings]&#41;;)

[//]: # ()
[//]: # (  return &#40;)

[//]: # (    <MenuToggle placement="bottom-end" ToggleButton={ToggleMenuButton}>)

[//]: # (      {/* Display recordings data in a list */})

[//]: # (      <CallRecordingList)

[//]: # (        callRecordings={callRecordings})

[//]: # (        loading={loadingCallRecordings})

[//]: # (      />)

[//]: # (    </MenuToggle>)

[//]: # (  &#41;;)

[//]: # (};)

[//]: # ()
[//]: # (const ToggleMenuButton = forwardRef<HTMLButtonElement, ToggleMenuButtonProps>&#40;)

[//]: # (  &#40;{ menuShown }, ref&#41; => {)

[//]: # (    return &#40;)

[//]: # (      <IconButton)

[//]: # (        icon="call-recordings")

[//]: # (        ref={ref})

[//]: # (        title={menuShown ? 'Close' : 'Call recordings'})

[//]: # (      />)

[//]: # (    &#41;;)

[//]: # (  },)

[//]: # (&#41;;)

[//]: # (```)

[//]: # ()
[//]: # (## Call recording listing SDK components)

[//]: # ()
[//]: # (The React SDK provides [`CallRecordingList`]&#40;../../ui-components/call/call-recordings-list&#41; component to display call recordings.)
