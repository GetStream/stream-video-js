---
id: tutorial
sidebar_position: 2
title: Tutorial
---

In this tutorial, we are building a video chat application using the Stream Video Angular SDK. The topics we are covering:

- Installing the SDK
- Creating the call UI using built-in components
- User authentication
- Creating a new call
- Joining an existing call
- Introduction to our reactive state management

## Set Up Your Angular Environment

To follow the tutorial make sure you have [Angular CLI installed](https://angular.io/cli#installing-angular-cli).

## Create a new Angular project

Run the following command:

```
ng new video-example --routing false --style scss --inline-template --inline-style --skip-tests
```

## Install TODO

Install the Stream Video Angular SDK from `npm`:

```
npm install TODO
```

## Import the `StreamVideoModule`

All services and UI components defined by the SDK belong to the [`StreamVideoModule`](../../core/StreamVideoModule). Let's import this into our `app.module.ts`:

```typescript
import { NgModule } from '@angular/core';
import { BrowserModule } from '@angular/platform-browser';
import { StreamVideoModule } from '@stream-io/video-angular-sdk';

import { AppComponent } from './app.component';

@NgModule({
  declarations: [AppComponent],
  imports: [BrowserModule, StreamVideoModule],
  providers: [],
  bootstrap: [AppComponent],
})
export class AppModule {}
```

## Import the stylesheet

In this tutorial, we are using the built-in UI components, so we have to import the following stylesheet into the `styles.scss` file:

```scss
@import '@stream-io/video-styling/index.scss';
```

[You can use CSS as well](../../ui-components/theming-and-css/#usage).

Let's also add some very basic styling to our `styles.scss`:

```scss
body {
  margin: 0;
  background-color: #272a30;
  color: white;
  font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Oxygen-Sans,
    Ubuntu, Cantarell, Helvetica Neue, sans-serif;
}

html,
body,
app-root {
  height: 100%;
}

.container {
  height: 100%;
  min-height: 0;
  max-height: 100%;
  display: flex;
  flex-direction: column;
}
```

## Call UI

The call UI is straightforward to create. We only need one component. Let's replace the `template` field of the `app.component.ts` file with the following:

```html
<div class="container">
  <div>Call ID: {{ callId }}</div>
  <stream-call></stream-call>
</div>
```

## User authentication

To access the video API, we need to log in with a user. Here are the steps:

1. The [`StreamVideoService`](../../core/StreamVideoService) is an Angular service you need to inject into your component to access our reactive state store (more on that later) and video API.
2. Call the [`init`](../../core/StreamVideoService/#init) method of the `StreamVideoService` instance, and provide your API key. This method will create a [`StreamVideoClient`](../../core/StreamVideoClient) instance that you can use to access the video API. The `StreamVideoClient` class is shared across all JS-based SDK-s (React and React Native), ensuring that all of these SDK-s work coherently.
3. Call the [`connect`](../../core/StreamVideoClient/#connect) method of the `StreamVideoClient` instance and provide the necessary user credentials to log in with a user.

This is how our `app.component.ts` file looks like with the authentication logic added:

```typescript
import { Component } from '@angular/core';
import { StreamVideoService } from '@stream-io/video-angular-sdk';
import { environment } from '../environments/environment';

@Component({
  selector: 'app-root',
  template: `
    <div class="container">
      <div>Call ID: {{ callId }}</div>
      <stream-call></stream-call>
    </div>
  `,
  styles: [],
})
export class AppComponent {
  callId?: string;

  constructor(private videoService: StreamVideoService) {}

  async ngOnInit() {
    // TODO - user credentials should come from somewhere than the environment file
    // Preferrably, we should be able to use something like [guest authentication](https://getstream.io/chat/docs/javascript/authless_users/?language=javascript#guest-users) to have multiple users
    const apiKey = environment.apiKey;
    const token = environment.token;
    const user = environment.user;
    const baseCoordinatorUrl = environment.coordinatorUrl;
    const baseWsUrl = environment.wsUrl;
    this.videoService.init(apiKey, token, baseCoordinatorUrl, baseWsUrl);
    await this.videoService.videoClient?.connect(apiKey, token, user);
  }
}
```

## Call creation

To create a new call, invoke the [`createCall`](../../core/StreamVideoClient/#createcall) method of the `StreamVideoClient` instance.

This is how our `app.component.ts` file looks like with the call creation logic added:

```typescript
import { Component } from '@angular/core';
import { StreamVideoService } from '@stream-io/video-angular-sdk';
import { environment } from '../environments/environment';

@Component({
  selector: 'app-root',
  template: `
    <div class="container">
      <div>Call ID: {{ callId }}</div>
      <stream-call></stream-call>
    </div>
  `,
  styles: [],
})
export class AppComponent {
  callId?: string;

  constructor(private videoService: StreamVideoService) {}

  async ngOnInit() {
    const apiKey = environment.apiKey;
    const token = environment.token;
    const user = environment.user;
    const baseCoordinatorUrl = environment.coordinatorUrl;
    const baseWsUrl = environment.wsUrl;
    this.videoService.init(apiKey, token, baseCoordinatorUrl, baseWsUrl);
    await this.videoService.videoClient?.connect(apiKey, token, user);
    this.callId = await this.createCall();
  }

  private async createCall() {
    const response = await this.videoService.videoClient?.createCall({
      type: 'default',
    });
    const callId = response?.call?.id;
    return callId;
  }
}
```

## Joining a call

To join a call, pass the call ID to the [`joinCall`](../../core/StreamVideoClient/#joincall) method of the `StreamVideoClient` instance. This method will return a [`Call`](../../core/Call) instance that represents the active call the user is part of. We have to call the [`join`](../../core/Call/#join) method of this instance.

For performance reasons, it's advised to join the call outside of the Angular change detection zone. This practice will prevent unnecessary change detection runs due to irrelevant WebSocket events.

This is how our `app.component.ts` file looks like with the join logic added:

```typescript
import { Component, NgZone } from '@angular/core';
import { StreamVideoService } from '@stream-io/video-angular-sdk';
import { environment } from '../environments/environment';

@Component({
  selector: 'app-root',
  template: `
    <div class="container">
      <div>Call ID: {{ callId }}</div>
      <stream-call></stream-call>
    </div>
  `,
  styles: [],
})
export class AppComponent {
  callId?: string;

  constructor(
    private videoService: StreamVideoService,
    private ngZone: NgZone,
  ) {}

  async ngOnInit() {
    const apiKey = environment.apiKey;
    const token = environment.token;
    const user = environment.user;
    const baseCoordinatorUrl = environment.coordinatorUrl;
    const baseWsUrl = environment.wsUrl;
    this.videoService.init(apiKey, token, baseCoordinatorUrl, baseWsUrl);
    await this.videoService.videoClient?.connect(apiKey, token, user);
    this.callId = await this.createCall();
    await this.joinCall(this.callId);
  }

  private async createCall() {
    const response = await this.videoService.videoClient?.createCall({
      type: 'default',
    });
    const callId = response?.call?.id;
    return callId;
  }

  private async joinCall(callId?: string) {
    if (!callId) {
      return;
    }
    const call = await this.ngZone.runOutsideAngular(() => {
      return this.videoService.videoClient?.joinCall({
        id: callId,
        type: 'default',
        datacenterId: '',
      });
    });
    await call?.join();
  }
}
```

## Let's run the application

Run the application with the following command:

```
npm start
```

If we run the application, we will start a new call and join that call immediately. We are the only participants in the call. In the next step, we are adding new participants to the call, but for now, let's explore the `stream-call` component.

The `stream-call` component takes care of the followings:

- Asking for permission to start video and audio streams
- Displaying all call participants in a grid
- We can select which audio and video devices to use for the call
- We can turn on and off our audio and video streams
- We can share our screen with participants
- We can record the call

Let's spend some time exploring these features.

## Joining with another user

In this step, we are extending our application with an input where users can provide the ID of an existing call they want to join.

This is how our `app.component.ts` file looks like after adding the input:

```typescript
import { Component, NgZone } from '@angular/core';
import { StreamVideoService } from '@stream-io/video-angular-sdk';
import { environment } from '../environments/environment';

@Component({
  selector: 'app-root',
  template: `
    <div class="container">
      <div>
        <input #input /><button (click)="createOrJoinCall(input.value)">
          Create or join call
        </button>
      </div>
      <div>Call ID: {{ callId }}</div>
      <stream-call></stream-call>
    </div>
  `,
  styles: [],
})
export class AppComponent {
  callId?: string;

  constructor(
    private videoService: StreamVideoService,
    private ngZone: NgZone,
  ) {}

  async ngOnInit() {
    const apiKey = environment.apiKey;
    const token = environment.token;
    const user = environment.user;
    const baseCoordinatorUrl = environment.coordinatorUrl;
    const baseWsUrl = environment.wsUrl;
    this.videoService.init(apiKey, token, baseCoordinatorUrl, baseWsUrl);
    await this.videoService.videoClient?.connect(apiKey, token, user);
  }

  async createOrJoinCall(callId?: string) {
    if (!callId) {
      callId = await this.createCall();
    }
    this.callId = callId;
    this.joinCall(callId);
  }

  private async createCall() {
    const response = await this.videoService.videoClient?.createCall({
      type: 'default',
    });
    const callId = response?.call?.id;
    return callId;
  }

  private async joinCall(callId?: string) {
    if (!callId) {
      return;
    }
    const call = await this.ngZone.runOutsideAngular(() => {
      return this.videoService.videoClient?.joinCall({
        id: callId,
        type: 'default',
        datacenterId: '',
      });
    });
    await call?.join();
  }
}
```

With this, we can open the application in multiple browser tabs and join the same call with various users. Let's try that.

## Detect number of participants - reactive state store

Our SDK uses a design pattern that we refer to as reactive state store. This means that each state variable is exposed as an RxJS Observable in the `StreamVideoService`. We can subscribe to the relevant variables and get notified about state changes that we are interested in.

Here are a few examples of state variables

- `activeCall$`: the call the logged-in user currently participates in
- `participants$:`: the list of participants in the active call
- `callRecordingInProgress$` tells if the active call is being recorded or not

The reactive state store makes it possible to observe the state from anywhere in your application: let's subscribe to the `participants$` variable and detect the number of participants in the call.

We can implement this in the `constructor` of our `app.component.ts`:

```typescript
this.streamVideoService.participants$
  .pipe(distinctUntilKeyChanged('length'))
  .subscribe((participants) =>
    console.log(
      `There are ${participants?.length || 0} participant(s) in the call`,
    ),
  );
```

This is the full content of the `app.component.ts` file:

```typescript
import { Component, NgZone, OnInit } from '@angular/core';
import { StreamVideoService } from '@stream-io/video-angular-sdk';
import { environment } from '../environments/environment';
import { distinctUntilKeyChanged } from 'rxjs';

@Component({
  selector: 'app-root',
  template: `
    <div class="container">
      <div>
        <input #input /><button (click)="createOrJoinCall(input.value)">
          Create or join call
        </button>
      </div>
      <div>Call ID: {{ callId }}</div>
      <stream-call></stream-call>
    </div>
  `,
})
export class AppComponent implements OnInit {
  callId?: string;

  constructor(
    private streamVideoService: StreamVideoService,
    private ngZone: NgZone,
  ) {
    this.streamVideoService.participants$
      .pipe(distinctUntilKeyChanged('length'))
      .subscribe((participants) =>
        console.log(
          `There are ${participants?.length || 0} participant(s) in the call`,
        ),
      );
  }

  async ngOnInit() {
    const apiKey = environment.apiKey;
    const token = environment.token;
    const user = environment.user;
    const baseCoordinatorUrl = environment.coordinatorUrl;
    const baseWsUrl = environment.wsUrl;
    const client = this.streamVideoService.init(
      apiKey,
      token,
      baseCoordinatorUrl,
      baseWsUrl,
    );
    await client.connect(apiKey, token, user);
  }

  async createOrJoinCall(callId?: string) {
    if (!callId) {
      callId = await this.createCall();
    }
    this.callId = callId;
    this.joinCall(callId);
  }

  private async createCall() {
    const response = await this.streamVideoService.videoClient?.createCall({
      type: 'default',
    });
    const callId = response?.call?.id;
    return callId;
  }

  private async joinCall(callId?: string) {
    if (!callId) {
      return;
    }
    const call = await this.ngZone.runOutsideAngular(() => {
      return this.streamVideoService.videoClient?.joinCall({
        id: callId,
        type: 'default',
        datacenterId: '',
      });
    });
    await call?.join();
  }
}
```

The reactive state store and our high-level video API make it very easy to create your own video application using either built-in or custom components.

## Where to go next

TODO
