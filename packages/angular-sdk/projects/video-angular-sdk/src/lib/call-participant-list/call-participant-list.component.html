<div class="str-video__participant-list str-video">
  <div class="str-video__participant-list-header">
    <div #customHeader>
      <ng-content select="[participant-list-header]"></ng-content>
    </div>
    <div
      *ngIf="!customHeader.children.length"
      class="str-video__participant-list-header__title"
    >
      Participants&nbsp;
      <span> ({{ (participants$ | async)?.length || 0 }}) </span>
    </div>
    <button
      (click)="listClosed()"
      class="str-video__participant-list-header__close-button"
    >
      <span
        class="str-video__participant-list-header__close-button--icon"
      ></span>
    </button>
  </div>
  <div>
    <div #customSearch>
      <ng-content select="[participant-list-search]"></ng-content>
    </div>
    <div
      *ngIf="!customSearch.children.length"
      class="str-video__search-input__container"
      [class.str-video__search-input__container--active]="input.value"
    >
      <input placeholder="Search" #input (input)="searchChanged(input.value)" />
      <button
        *ngIf="input.value"
        class="str-video__search-input__clear-btn"
        (click)="searchCleared(); input.value = ''"
      >
        <span class="str-video__search-input__icon--active"></span>
      </button>
      <span *ngIf="!input.value" class="str-video__search-input__icon"></span>
    </div>
  </div>
  <div class="str-video__participant-list__content">
    <div #customList>
      <ng-content select="[participant-list]"></ng-content>
    </div>
    <ng-container *ngIf="!customList.children.length">
      <div
        class="str-video__participant-list--empty"
        *ngIf="!(participants$ | async)?.length"
      >
        No participants found
      </div>
      <ng-container *ngFor="let participant of participants$ | async">
        <popper-content #fullName>
          <div class="str-video__tooltip">
            {{ participant?.user?.name }}
            {{ participant?.isLoggedInUser ? '(Me)' : '' }}
          </div>
        </popper-content>
        <div class="str-video__participant-listing-item">
          <div class="str-video__participant-listing-item__display-name">
            <span
              [popper]="fullName"
              [popperTrigger]="popperTrigger"
              [popperPlacement]="popperPlacement"
            >
              {{ participant?.user?.name }}
              {{ participant?.isLoggedInUser ? '(Me)' : '' }}
            </span>
          </div>
          <div
            class="str-video__participant-listing-item__media-indicator-group"
          >
            <div
              class="str-video__participant-listing-item__icon str-video__participant-listing-item__icon-{{
                participant.publishedTracks.includes(TrackType.AUDIO)
                  ? 'mic'
                  : 'mic-off'
              }}"
            ></div>
            <div
              class="str-video__participant-listing-item__icon str-video__participant-listing-item__icon-{{
                participant.publishedTracks.includes(TrackType.VIDEO)
                  ? 'camera'
                  : 'camera-off'
              }}"
            ></div>
          </div>
        </div>
      </ng-container>
    </ng-container>
  </div>
  <ng-content select="[participant-list-footer]"></ng-content>
</div>
